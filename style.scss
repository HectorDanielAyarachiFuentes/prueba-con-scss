// --- 1. CONFIGURACIÓN DEL TEMA "AURORA" ---
// (Sin cambios)
$num-options: 5;
$main-bubble-size: 70px;
$option-bubble-size: 55px;
$spread-radius: 120px;
$start-angle: -90deg;
$arc-angle: 180deg;
$color-deep-space: #1d123b;
$color-purple: #9d4edd;
$color-magenta: #e040fb;
$color-cyan: #00f5d4;
$color-glow: rgba($color-cyan, 0.7);
$deploy-duration: 0.6s;
$stagger-delay: 0.08s;
$deploy-easing: cubic-bezier(0.34, 1.56, 0.64, 1);

// --- 2. FUNCIONES TRIGONOMÉTRICAS ---
// (Sin cambios, son necesarias)
@function pow($b, $e) { $r: 1; @for $i from 1 through $e { $r: $r * $b; } @return $r; } @function fact($n) { $r: 1; @if $n > 0 { @for $i from 1 through $n { $r: $r * $i; } } @return $r; } @function pi() { @return 3.14159265359; } @function rad($a) { @return $a / 180 * pi(); } @function sin($a) { $s: 0; @for $i from 0 through 10 { $s: $s + pow(-1, $i) * pow(rad($a), 2 * $i + 1) / fact(2 * $i + 1); } @return $s; } @function cos($a) { $c: 0; @for $i from 0 through 10 { $c: $c + pow(-1, $i) * pow(rad($a), 2 * $i) / fact(2 * $i); } @return $c; }

// --- 3. KEYFRAMES ANIMADOS ---
// (Sin cambios)
@keyframes aurora-gradient { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
@keyframes pulse-glow { 0%, 100% { transform: scale(1); filter: drop-shadow(0 0 5px $color-glow); } 50% { transform: scale(1.05); filter: drop-shadow(0 0 15px $color-glow); } }

// --- 4. ESTILOS BASE ---
// (Sin cambios)
body { display: flex; justify-content: center; align-items: center; min-height: 100vh; background-color: $color-deep-space; overflow: hidden; }

// --- 5. EL SISTEMA DE BURBUJAS (CORREGIDO) ---
.bubble-container {
  position: relative;
  
  // (Trigger sin cambios)
  .bubble-trigger { width: $main-bubble-size; height: $main-bubble-size; border-radius: 50%; background: conic-gradient(from 0deg, $color-purple, $color-magenta, $color-cyan, $color-purple); position: relative; z-index: 10; cursor: pointer; transition: transform 0.3s ease; animation: pulse-glow 3s infinite ease-in-out; .icon-wrapper { display: flex; justify-content: center; align-items: center; width: 100%; height: 100%; color: white; font-size: 2em; transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); } }

  // El <li> ahora solo es un ancla de posicionamiento
  .bubble-options li {
    position: absolute;
    list-style: none;
    // Centramos el ancla para que la animación parta del centro
    top: ($main-bubble-size - $option-bubble-size) / 2;
    left: ($main-bubble-size - $option-bubble-size) / 2;
    // Hacemos que la animación actúe sobre el <li> para mover el <a> que contiene
    opacity: 0;
    pointer-events: none;

    // AHORA LOS ESTILOS VISUALES VAN AQUÍ, EN EL 'a'
    a {
      display: flex;
      justify-content: center;
      align-items: center;
      width: $option-bubble-size;      // <-- CAMBIO
      height: $option-bubble-size;     // <-- CAMBIO
      border-radius: 50%;              // <-- CAMBIO
      text-decoration: none;
      color: white;
      font-size: 1.5em;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      
      // El increíble gradiente animado, ahora en el elemento correcto
      background: linear-gradient(45deg, $color-purple, $color-magenta, $color-cyan); // <-- CAMBIO
      background-size: 400% 400%;                                                    // <-- CAMBIO
      animation: aurora-gradient 5s ease infinite;                                  // <-- CAMBIO
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);                                    // <-- CAMBIO

      &:hover {
        transform: scale(1.2) rotate(10deg);
        box-shadow: 0 8px 25px $color-glow;
      }
    }
  }

  // --- 6. LA MAGIA GENERATIVA (CORREGIDA) ---
  &:hover {
    .bubble-trigger .icon-wrapper { transform: rotate(360deg) scale(0.8); }
    // Al hacer hover, activamos el <li> para que la animación de posición se ejecute
    .bubble-options li {
      opacity: 1;
      pointer-events: auto;
    }
  }
  
  @for $i from 1 through $num-options {
    $angle: $start-angle + (($arc-angle / ($num-options - 1)) * ($i - 1));
    $x: cos($angle) * $spread-radius;
    $y: sin($angle) * $spread-radius;
    
    // El @keyframes ahora solo controla la posición y la escala del <li>
    @keyframes deploy-bubble-#{$i} {
      0%   { transform: translate(0, 0) scale(0); }
      60%  { transform: translate($x * 1.1, $y * 1.1) scale(1.1); }
      100% { transform: translate($x, $y) scale(1); }
    }

    // Aplicamos la animación de POSICIÓN al <li>
    .bubble-options li:nth-child(#{$i}) {
      .bubble-container:hover & {
        animation-name: deploy-bubble-#{$i};
        animation-duration: $deploy-duration;
        animation-timing-function: $deploy-easing;
        animation-delay: $stagger-delay * ($i - 1);
        animation-fill-mode: forwards;
      }
    }
  }
}